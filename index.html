<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scroll-Controlled Animations</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      height: 600vh;
      background: #0B0B0B;
      overflow-x: hidden
    }

    #loading-screen {
      position: fixed;
      inset: 0;
      background: #121212;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      color: #fff;
      transition: opacity .5s
    }

    .loader {
      width: 48px;
      height: 48px;
      border: 5px solid #fff;
      border-bottom-color: transparent;
      border-radius: 50%;
      animation: rotation 1s linear infinite;
      margin-bottom: 20px
    }

    @keyframes rotation {
      0% {
        transform: rotate(0)
      }

      100% {
        transform: rotate(360deg)
      }
    }

    .loading-progress {
      width: 250px;
      background: #333;
      border-radius: 8px;
      margin-top: 15px;
      overflow: hidden
    }

    .loading-bar {
      height: 10px;
      background: #4CAF50;
      width: 0;
      border-radius: 8px;
      transition: width .3s
    }

    .scroll-section {
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      overflow: hidden;
      color: #fff;
      text-align: center
    }

    .frame-container {
      position: absolute;
      inset: 0;
      overflow: hidden
    }

    .frame-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      position: absolute;
      inset: 0
    }

    .text-content {
      position: relative;
      z-index: 1;
      padding: 20px;
      background: rgba(0, 0, 0, .5);
      border-radius: 10px;
      max-width: 80%
    }

    .text-content h2,
    .text-content p {
      opacity: 0;
      transform: translateY(20px)
    }

    header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: rgba(20, 20, 20, .8);
      padding: 10px 20px;
      z-index: 100;
      display: flex;
      justify-content: space-around
    }

    header a {
      color: #fff;
      text-decoration: none;
      font-weight: bold
    }

    .content-after {
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #ddd;
      text-align: center
    }

    .content-container {
      opacity: 0;
      transition: opacity .5s
    }

    .content-container.loaded {
      opacity: 1
    }
  </style>
</head>

<body>
  <div id="loading-screen"><span class="loader"></span>
    <h2 id="loading-status">Loading assets…</h2>
    <div class="loading-progress">
      <div id="loading-bar" class="loading-bar"></div>
    </div>
  </div>

  <div class="content-container" id="content-container">
    <header><a href="#section1">Section 1</a><a href="#section2">Section 2</a><a href="#after">After</a></header>

    <section id="section1" class="scroll-section">
      <div class="frame-container"><img id="frame1" src="video1/0001.jpg" alt=""></div>
      <div class="text-content" id="text1">
        <h2>Welcome to Section 1</h2>
        <p id="text1-p1">Scroll down to see the magic.</p>
        <p id="text1-p2">The frames play as you scroll.</p>
        <p id="text1-p3">Then they pause, but text continues.</p>
        <p id="text1-p4">And finally, the animation resumes.</p>
      </div>
    </section>

    <section id="section2" class="scroll-section">
      <div class="frame-container"><img id="frame2" src="video2/0001.jpg" alt=""></div>
      <div class="text-content" id="text2">
        <h2>This is Section 2</h2>
        <p id="text2-p1">A different animation sequence.</p>
        <p id="text2-p2">Controlled entirely by your scroll.</p>
      </div>
    </section>

    <section id="after" class="content-after">
      <h2>Content After Animations</h2>
      <p>Normal scrolling resumes here.</p>
    </section>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollToPlugin.min.js"></script>
  <script>
    gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

    document.addEventListener('DOMContentLoaded', () => {
      document.body.style.overflow = 'hidden';
      const content = document.getElementById('content-container');
      const loadingScreen = document.getElementById('loading-screen');
      const bar = document.getElementById('loading-bar');
      const status = document.getElementById('loading-status');

      const frames1 = Array.from({ length: 240 }, (_, i) => `video1/${String(i + 1).padStart(4, '0')}.jpg`);
      const frames2 = Array.from({ length: 180 }, (_, i) => `video2/${String(i + 1).padStart(4, '0')}.jpg`);
      const total = frames1.length + frames2.length;
      let loaded = 0;

      [...frames1, ...frames2].forEach(src => {
        const img = new Image();
        img.src = src;
        img.onload = img.onerror = () => { loaded++; bar.style.width = `${loaded / total * 100}%`; status.textContent = `Loading assets… ${Math.round(loaded / total * 100)}%`; if (loaded === total) ready() };
      });

      function ready() {
        setTimeout(() => { loadingScreen.style.opacity = '0'; content.classList.add('loaded'); setTimeout(() => { loadingScreen.style.display = 'none'; document.body.style.overflow = ''; init(); ScrollTrigger.refresh() }, 500) }, 300);
      }
    });

    function init() {
      const img1 = document.getElementById('frame1');
      const img2 = document.getElementById('frame2');
      const f1 = Array.from({ length: 240 }, (_, i) => `video1/${String(i + 1).padStart(4, '0')}.jpg`);
      const f2 = Array.from({ length: 180 }, (_, i) => `video2/${String(i + 1).padStart(4, '0')}.jpg`);

      const obj1 = { frame: 0 };
      const tl1 = gsap.timeline({ scrollTrigger: { trigger: "#section1", start: "top top", end: "+=250%", scrub: true, pin: true, anticipatePin: 1 } });
      tl1.to(obj1, { frame: 59, duration: 3, ease: "none", onUpdate: () => { img1.src = f1[Math.round(obj1.frame)] } }, 0);
      tl1.to(obj1, { frame: 239, duration: 4, ease: "none", onUpdate: () => { img1.src = f1[Math.round(obj1.frame)] } }, 6);
      tl1.to(["#text1 h2", "#text1-p1"], { opacity: 1, y: 0, stagger: .2, duration: 1 }, 0);
      tl1.to("#text1-p2", { opacity: 1, y: 0, duration: 1 }, 1);
      tl1.to("#text1-p3", { opacity: 1, y: 0, duration: 1 }, 3);
      tl1.to("#text1-p4", { opacity: 1, y: 0, duration: 1 }, 5);
      tl1.to("#text1 .text-content>*", { opacity: 0, y: -20, stagger: .1, duration: 2 }, 8);
      tl1.totalDuration(10);

      const obj2 = { frame: 0 };
      const tl2 = gsap.timeline({ scrollTrigger: { trigger: "#section2", start: "top top", end: "+=200%", scrub: true, pin: true, anticipatePin: 1 } });
      tl2.to(obj2, { frame: 179, duration: 5, ease: "none", onUpdate: () => { img2.src = f2[Math.round(obj2.frame)] } }, 0);
      tl2.to(["#text2 h2", "#text2-p1"], { opacity: 1, y: 0, stagger: .3, duration: 1 }, .5);
      tl2.to("#text2-p2", { opacity: 1, y: 0, duration: 1 }, 2);
      tl2.to("#text2 .text-content>*", { opacity: 0, y: -20, stagger: .2, duration: 1 }, 4);
      tl2.totalDuration(5);

      document.querySelectorAll('header a[href^="#"]').forEach(a => {
        a.addEventListener('click', e => {
          e.preventDefault();
          gsap.to(window, { duration: 1, scrollTo: { y: a.getAttribute('href'), offsetY: 70 }, ease: "power2.inOut" });
        });
      });
      window.addEventListener('resize', () => ScrollTrigger.refresh());
    }
  </script>
</body>

</html>